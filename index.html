<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>SharpShare — Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Basic page styles (kept inline for a simple, single-file deployment) -->
  <style>
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#0f172a;color:#e5e7eb}
    .container{max-width:900px;margin:0 auto;padding:1rem}
    header{border-bottom:1px solid #1f2937}
    .brand{color:#e5e7eb;text-decoration:none;font-weight:700}
    nav a,nav span{margin-left:1rem;color:#e5e7eb;text-decoration:none}
    h1{margin:1rem 0}
    .button{background:#22c55e;color:#111;padding:.5rem .8rem;border-radius:.5rem;text-decoration:none}
    .row{display:flex;justify-content:space-between;align-items:center}
    .footer{border-top:1px solid #1f2937;color:#9ca3af;margin-top:2rem;padding:1rem 0}
  </style>

  <!-- Load the Supabase client library from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>
    /*
      PURPOSE:
      - Show a top navigation bar that changes depending on whether a user is logged in.
      - We only need to read the current session; all auth logic happens on login/signup pages.
    */

    // 1) Your Supabase project info (public anon key is safe to use in the browser; RLS protects data)
    const SUPABASE_URL = "https://qkpgnywwzisggfufwxsj.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFrcGdueXd3emlzZ2dmdWZ3eHNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQyNzM5MTQsImV4cCI6MjA3OTg0OTkxNH0.-VFfjAQOgTAX8UtFVjg0KE2Nr7FYh5a0THIqL4kmqwk";

    // 2) Create a Supabase client to talk to your database/auth
    const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // 3) Build the navbar HTML depending on whether the user is logged in
    async function renderNav(){
      // Ask Supabase for the current user (if logged in)
      const { data:{ user } } = await sb.auth.getUser();

      // Insert a header with links. Logged-in users see Dashboard/Create/Logout.
      // Logged-out users see Login/Signup.
      const nav = document.getElementById("nav");
      nav.innerHTML = `
        <header>
          <div class="container row">
            <a class="brand" href="index.html">SharpShare</a>
            <nav>
              <a href="feed.html">Feed</a>
              ${user ? `
                <a href="dashboard.html">My Posts</a>
                <a href="create.html">Create</a>
                <a href="logout.html">Logout</a>
              ` : `
                <a href="login.html">Login</a>
                <a href="signup.html">Sign up</a>
              `}
            </nav>
          </div>
        </header>`;
    }

    // 4) Run after the page loads
    document.addEventListener('DOMContentLoaded', renderNav);
  </script>
</head>
<body>
  <!-- Navbar placeholder; JavaScript fills this in -->
  <div id="nav"></div>

  <!-- Page content -->
  <main class="container">
    <h1>Welcome to SharpShare!</h1>
    <h4>Picks built by the crowd.</h4>
    <p>
      This site shows a public feed. To create, edit, or delete posts,
      you must log in. 
    </p>
    <p><a class="button" href="feed.html">Go to Feed</a></p>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <small>© <span id="y"></span> SharpShare</small>
    </div>
  </footer>

  <script>
    // Replace the footer year with the current year
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>
</body>
</html>
